# NAVER WORKS 통계 페이지 자동화 도구

NAVER WORKS 통계 페이지에서 여러 기관 계정으로 로그인 후, 통계 페이지별로 날짜 지정 → 그래프 캡처 → 엑셀 다운로드까지 자동화하는 도구입니다.

## 🚀 주요 기능

- **다중 계정 지원**: 12개 기관 계정 자동 처리
- **스마트 로그인**: 쿠키 기반 자동 로그인 및 2차 인증 지원
- **페이지별 처리**: 각 통계 페이지 타입에 맞는 최적화된 처리
- **자동 캡처**: 그래프 스크린샷 자동 저장
- **엑셀 다운로드**: 통계 데이터 엑셀 파일 자동 다운로드

## 📋 지원 기관

1. 기관A (example1.org)
2. 기관B (example2.org)
3. 기관C (example3.org)
4. 기관D (example4.org)
5. 기관E (example5.org)
6. 기관F (example6.org)
7. 기관G (example7.org)
8. 기관H (example8.org)
9. 기관I (example9.org)
10. 기관J (example10.org)
11. 기관K (example11.org)
12. 기관L (example12.org)

## 📊 지원 통계 페이지

### A. 그래프 2개인 페이지
- 계정 (구성원수, 활성사용자)
- 액티브 유저
- 공용용량
- 게시판

### B. 탭이 있는 그래프 1개 페이지
- 주소록 (외부연락처, 그룹)

### C. 일반 그래프 1개 페이지
- 메시지
- 캘린더
- 설문
- 할 일

### D. 메일 페이지 (특수)
- 보낸 메일 수
- 받은 메일 수

## 🛠️ 설치 방법

1. **Python 3.8+ 설치**
2. **Chrome 브라우저 설치**
3. **의존성 패키지 설치**:
   ```bash
   pip install -r requirements.txt
   ```

## 🚀 사용 방법

### 1. 초기 설정
```bash
python naverworks_automation.py
```

### 2. 계정 선택
프로그램 실행 시 사용 가능한 계정 목록이 표시됩니다. 번호를 입력하여 원하는 계정을 선택하세요.

### 3. 로그인
- 처음 실행 시: 수동으로 로그인 및 2차 인증을 완료한 후 Enter를 누르세요
- 이후 실행 시: 저장된 쿠키를 사용하여 자동 로그인됩니다

### 4. 날짜 입력
YYYY.MM.DD 형식으로 시작일과 종료일을 입력하세요.

### 5. 자동 처리
선택한 계정의 모든 통계 페이지가 자동으로 처리됩니다.

## 📁 출력 파일 구조

```
report/
├── {기관명}/
│   ├── 계정/
│   │   ├── 계정_구성원수.png
│   │   ├── 계정_활성사용자.png
│   │   └── 계정.xlsx
│   ├── 메일/
│   │   ├── 메일_보낸 메일 수.png
│   │   ├── 메일_받은 메일 수.png
│   │   └── 메일_보낸받은메일수.xlsx
│   └── ...
```

## 🔧 설정 파일

### naverworks_accounts.py
계정 목록과 통계 페이지 URL을 관리하는 설정 파일입니다.

```python
# 계정 목록
ACCOUNTS = [
    "기관A (example1.org)",
    # ... 기타 계정들
]

# 통계 페이지 목록 (URL, 페이지명)
TARGET_PAGES = [
    ("https://demo.example.com/statistics/accounts", "계정"),
    # ... 기타 페이지들
]
```

## 🔐 로그인 URL 규칙

- **기관L (example12.org)**: https://demo.example.com
- **기관A (example1.org)**: https://demo.example.com/sso/user/login/view?agt_id=kiep-naver
- **그 외 모든 기관**: https://demo.example.com/kr/console/openapi/v2/app/list/view

## 📝 주의사항

1. **2차 인증**: 처음 로그인 시 2차 인증(MFA)이 필요할 수 있습니다.
2. **쿠키 관리**: 쿠키는 `cookies/` 디렉토리에 저장되며, 만료 시 재로그인이 필요합니다.
3. **네트워크**: 안정적인 인터넷 연결이 필요합니다.
4. **권한**: 통계 페이지 접근 권한이 있는 계정만 사용 가능합니다.

## 🐛 문제 해결

### 로그인 실패
- 쿠키 파일을 삭제하고 재로그인을 시도하세요
- 2차 인증이 올바르게 완료되었는지 확인하세요

### 그래프 캡처 실패
- 페이지 로딩 시간을 늘려보세요
- 브라우저 창이 최소화되지 않았는지 확인하세요

### 다운로드 실패
- 브라우저의 다운로드 설정을 확인하세요
- 충분한 디스크 공간이 있는지 확인하세요